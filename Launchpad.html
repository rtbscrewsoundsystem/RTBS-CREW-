
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Novation Launchpad Clone</title>
    <style>
        :root {
            --chassis: #1a1a1b;
            --pad-empty: #313131;
            --pad-border: #111;
            --btn-circular: #444;
            --led-on: #00ff55;
            --led-loop: #ff2255;
        }

        body {
            background: #050505;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            font-family: sans-serif;
        }

        /* El cuerpo del Launchpad */
        .lp-chassis {
            background: var(--chassis);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.8);
            display: grid;
            grid-template-columns: repeat(8, 45px) 50px; /* 8 pads + botones redondos */
            grid-template-rows: 50px repeat(8, 45px);   /* Botones superiores + 8 pads */
            gap: 6px;
            border: 4px solid #000;
        }

        /* Estilo general de botones */
        .cell {
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        /* Pads cuadrados centrales */
        .pad {
            background: var(--pad-empty);
            border-radius: 3px;
            box-shadow: inset 0 0 5px rgba(0,0,0,0.5);
            transition: all 0.05s;
        }

        /* Botones redondos (arriba y derecha) */
        .round-btn {
            background: var(--btn-circular);
            border-radius: 50%;
            width: 35px;
            height: 35px;
            justify-self: center;
            align-self: center;
        }

        /* Estados de iluminación */
        .pad.active {
            background: var(--led-on);
            box-shadow: 0 0 15px var(--led-on);
        }

        .pad.looping {
            background: var(--led-loop);
            box-shadow: 0 0 20px var(--led-loop);
            animation: pulse 1s infinite alternate;
        }

        @keyframes pulse {
            from { opacity: 1; }
            to { opacity: 0.6; }
        }

        /* Logo o texto */
        .brand {
            grid-column: 1 / 5;
            color: #555;
            font-size: 10px;
            font-weight: bold;
            display: flex;
            align-items: center;
            padding-left: 5px;
        }
    </style>
</head>
<body>

    <div class="lp-chassis" id="launchpad">
        <div class="brand">WEB PAD</div>
        <div class="cell round-btn"></div>
        <div class="cell round-btn"></div>
        <div class="cell round-btn"></div>
        <div class="cell round-btn"></div>
        <div class="cell round-btn"></div>

        </div>

    <script>
        const lp = document.getElementById('launchpad');
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        const loops = {}; // Almacena sonidos activos

        // Generar la rejilla de 8x8 + botones laterales
        for (let row = 0; row < 8; row++) {
            // 8 Pads cuadrados
            for (let col = 0; col < 8; col++) {
                const pad = document.createElement('div');
                pad.className = 'cell pad';
                const padId = `p-${row}-${col}`;
                pad.id = padId;
                
                pad.addEventListener('pointerdown', () => triggerPad(padId, row, col));
                lp.appendChild(pad);
            }
            // 1 Botón redondo lateral derecho
            const rBtn = document.createElement('div');
            rBtn.className = 'cell round-btn';
            lp.appendChild(rBtn);
        }

        async function triggerPad(id, r, c) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            
            const element = document.getElementById(id);

            // LOGICA: Si es la primera fila, lo tratamos como LOOP
            const isLoopType = (r === 0); 

            if (loops[id]) {
                // Si ya está loopeando, lo apagamos
                loops[id].stop();
                delete loops[id];
                element.classList.remove('looping');
            } else {
                // Reproducir sonido (usamos osciladores simples para no depender de internet en el ejemplo)
                const source = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                
                source.type = r % 2 === 0 ? 'sine' : 'square';
                source.frequency.setValueAtTime(100 + (c * 50) + (r * 20), audioCtx.currentTime);
                
                source.connect(gain);
                gain.connect(audioCtx.destination);
                
                source.start();

                if (isLoopType) {
                    loops[id] = source;
                    element.classList.add('looping');
                } else {
                    element.classList.add('active');
                    source.stop(audioCtx.currentTime + 0.2);
                    setTimeout(() => element.classList.remove('active'), 150);
                }
            }
        }

        // Conexión MIDI para que el Launchpad físico controle esta skin
        if (navigator.requestMIDIAccess) {
            navigator.requestMIDIAccess().then(midi => {
                for (let input of midi.inputs.values()) {
                    input.onmidimessage = (msg) => {
                        const [status, note, vel] = msg.data;
                        if (status === 144 && vel > 0) {
                            // Mapeo básico de notas a la rejilla visual
                            const r = Math.floor(note / 16); // Depende del modo del Launchpad
                            const c = note % 8;
                            triggerPad(`p-${r}-${c}`, r, c);
                        }
                    };
                }
            });
        }
    </script>
</body>
</html>
